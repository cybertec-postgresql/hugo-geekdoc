{{ define "main" }}
  <div id="main-content" tabindex="-1" class="taxonomy-terms-page">
    {{- /* Page Header Section */ -}}
    <header class="taxonomy-terms-header">
      <h1 class="taxonomy-terms-title">{{ partial "utils/title" . }}</h1>
      {{- if .Description -}}
        <p class="taxonomy-terms-description">{{ .Description }}</p>
      {{- end -}}
      {{- if gt (len .Pages) 0 -}}
        <p class="taxonomy-terms-count" aria-live="polite">
          {{- $total := len .Pages -}}
          {{- printf "%d %s" $total (cond (eq $total 1) "term" "terms") -}}
        </p>
      {{- end -}}
    </header>

    {{- /* Main Content Grid */ -}}
    {{- if gt (len .Paginator.Pages) 0 -}}
      <div class="taxonomy-terms-grid" role="list">
        {{- range .Paginator.Pages.ByTitle -}}
          {{- $pageCount := len .Pages -}}
          {{- $latest := index (.Pages.ByDate.Reverse) 0 -}}
          <article 
            class="taxonomy-term-card" 
            role="listitem"
            aria-labelledby="term-{{ .Slug }}"
          >
            {{- /* Clickable Card Link - Entire card is clickable */ -}}
            <a 
              href="{{ .RelPermalink }}" 
              class="taxonomy-term-card__link"
              aria-label="View all pages for {{ partial "utils/title" . }}"
            >
              <header class="taxonomy-term-card__header">
                <h2 class="taxonomy-term-card__title" id="term-{{ .Slug }}">
                  {{- partial "utils/title" . -}}
                </h2>
              </header>

              <div class="taxonomy-term-card__body">
                {{- if .Description -}}
                  <p class="taxonomy-term-card__description">{{ .Description | truncate 120 }}</p>
                {{- else if $latest -}}
                  <p class="taxonomy-term-card__description">{{ $latest.Summary | plainify | truncate 120 }}</p>
                {{- else -}}
                  <p class="taxonomy-term-card__description taxonomy-term-card__description--empty">
                    No description available
                  </p>
                {{- end -}}
              </div>

              <footer class="taxonomy-term-card__footer">
                <div class="taxonomy-term-card__meta">
                  <span 
                    class="taxonomy-term-card__count"
                    aria-label="{{ $pageCount }} {{ cond (eq $pageCount 1) "page" "pages" }}"
                  >
                    <svg class="gdoc-icon gdoc_tag" aria-hidden="true">
                      <use xlink:href="#gdoc_tag"></use>
                    </svg>
                    <span class="taxonomy-term-card__count-text">
                      {{- $pageCount -}}
                      <span class="taxonomy-term-card__count-label">
                        {{- cond (eq $pageCount 1) "page" "pages" -}}
                      </span>
                    </span>
                  </span>

                  {{- if $latest -}}
                    <span class="taxonomy-term-card__latest">
                      <svg class="gdoc-icon gdoc_star" aria-hidden="true">
                        <use xlink:href="#gdoc_star"></use>
                      </svg>
                      <span class="taxonomy-term-card__latest-text">
                        Latest: 
                        <span class="taxonomy-term-card__latest-title">
                          {{- partial "utils/title" $latest | truncate 40 -}}
                        </span>
                      </span>
                    </span>
                  {{- end -}}
                </div>
              </footer>
            </a>
          </article>
        {{- end -}}
      </div>

      {{- /* Pagination */ -}}
      {{- if gt .Paginator.TotalPages 1 -}}
        {{- partial "pagination.html" . -}}
      {{- end -}}
    {{- else -}}
      {{- /* Empty State */ -}}
      <div class="taxonomy-terms-empty" role="status" aria-live="polite">
        <svg class="taxonomy-terms-empty__icon" aria-hidden="true">
          <use xlink:href="#gdoc_tag"></use>
        </svg>
        <h2 class="taxonomy-terms-empty__title">No terms found</h2>
        <p class="taxonomy-terms-empty__description">
          There are currently no {{ .Data.Plural }} available.
        </p>
      </div>
    {{- end -}}
  </div>
{{ end }}
